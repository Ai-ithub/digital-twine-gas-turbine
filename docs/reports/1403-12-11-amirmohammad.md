
### **گزارش کار**
**نام: امیر محمد شریفی**  
**تاریخ: ۱۴۰۳/۱۲/۱۱**

---
#### **1. مقدمه**
در این پروژه، هدف طراحی و پیاده‌سازی یک سیستم هوشمند برای پیش‌بینی وضعیت کمپرسور بود. این سیستم با استفاده از داده‌های ورودی (مانند ارتعاش، مصرف انرژی، دما و غیره) و یک مدل آموزش‌دیده، وضعیت کمپرسور را پیش‌بینی می‌کند. این گزارش به مرور مراحل مختلف انجام شده در این پروژه، از جمله آماده‌سازی داده‌ها، آموزش مدل PyTorch، تبدیل مدل به ONNX، و استفاده از دیتابیس SQL برای مدیریت داده‌ها می‌پردازد. همچنین، جزئیات فنی و تصمیمات طراحی در هر مرحله توضیح داده شده‌اند.

---

#### **2. مرور فایل‌ها**

##### **فایل اول: `database.py`**
این فایل شامل کلاس `Database` است که برای مدیریت داده‌های ورودی از دیتابیس SQL استفاده می‌شود. این کلاس نقش مهمی در خواندن داده‌های لحظه‌ای از دیتابیس و ارائه آن‌ها به سیستم پیش‌بینی دارد. وظایف اصلی این فایل عبارتند از:

- **خواندن داده‌ها:** متد `get_input_data` داده‌های مربوط به یک رکورد خاص (با شناسه `record_id`) را از جدول `compressor_data` می‌خواند. این متد اطمینان می‌دهد که داده‌های مورد نیاز برای پیش‌بینی به درستی استخراج شده‌اند.
- **مدیریت اتصال:** اتصال به دیتابیس در انتهای کار به درستی بسته می‌شود تا منابع سیستم بهینه استفاده شوند.

##### **فایل دوم: `predictor.py`**
این فایل شامل کلاس `CompressorStatusPredictor` است که برای پیش‌بینی وضعیت کمپرسور استفاده می‌شود. این کلاس نقش اصلی در اجرای مدل ONNX و پردازش داده‌های ورودی دارد. وظایف اصلی این فایل عبارتند از:

- **بارگذاری مدل ONNX:** مدل پیش‌بینی (`compressor_status_prediction_model.onnx`) بارگذاری می‌شود. این مدل قبلاً با استفاده از PyTorch آموزش داده شده و به فرمت ONNX تبدیل شده است.
- **استفاده از داده‌های دیتابیس:** آبجکت `Database` از فایل `database.py` ایمپورت شده و داده‌های ورودی از آن دریافت می‌شوند. این رویکرد اطمینان می‌دهد که داده‌های لحظه‌ای به درستی به سیستم پیش‌بینی منتقل شوند.
- **پیش‌پردازش داده‌ها:** داده‌های خوانده‌شده به فرمت مناسب برای مدل تبدیل می‌شوند. این شامل تبدیل داده‌ها به آرایه‌های NumPy و تنظیم ابعاد آن‌ها برای ورود به مدل است.
- **پیش‌بینی:** مدل ONNX بر روی داده‌های پیش‌پردازش‌شده اجرا شده و وضعیت کمپرسور پیش‌بینی می‌شود. خروجی مدل به صورت یک عدد صحیح (وضعیت پیش‌بینی‌شده) بازگردانده می‌شود.

---

#### **3. مراحل انجام شده**

##### **مرحله 1: آماده‌سازی داده‌ها**
آماده‌سازی داده‌ها یکی از مهم‌ترین مراحل در هر پروژه یادگیری ماشین است. در این پروژه، داده‌های خام از فایل CSV خوانده شدند و پیش‌پردازش‌های لازم بر روی آن‌ها انجام شد. جزئیات این مرحله عبارتند از:

- **خواندن داده‌ها:** داده‌های خام از فایل CSV خوانده شدند. این داده‌ها شامل ویژگی‌های مختلفی بودند که وضعیت کمپرسور را توصیف می‌کردند.
- **انتخاب ویژگی‌ها:** ویژگی‌های انتخاب‌شده شامل موارد زیر بودند:
  - **ارتعاش (`Vibration`):** میزان ارتعاش کمپرسور.
  - **مصرف انرژی (`Power_Consumption`):** مقدار انرژی مصرف‌شده توسط کمپرسور.
  - **بازدهی (`Efficiency`):** کارایی کمپرسور.
  - **دمای محیط (`Ambient_Temperature`):** دمای محیط اطراف کمپرسور.
  - **رطوبت (`Humidity`):** میزان رطوبت محیط.
  - **آلودگی هوا (`Air_Pollution`):** میزان آلودگی هوا در محیط کار.
  - **کیفیت نگهداری (`Maintenance_Quality`):** کیفیت خدمات نگهداری انجام‌شده.
  - **کیفیت سوخت (`Fuel_Quality`):** کیفیت سوخت مورد استفاده.
  - **ضریب بار (`Load_Factor`):** میزان بار کاری کمپرسور.
- **نرمال‌سازی داده‌ها:** داده‌ها با استفاده از `StandardScaler` نرمال‌سازی شدند. این کار به منظور کاهش تأثیر مقیاس‌های مختلف ویژگی‌ها بر عملکرد مدل انجام شد.
- **تقسیم داده‌ها:** داده‌ها به سه بخش تقسیم شدند:
  - **داده‌های آموزشی (`train`):** برای آموزش مدل استفاده شدند.
  - **داده‌های اعتبارسنجی (`validation`):** برای تنظیم هایپرپارامترها و جلوگیری از بیش‌برازش استفاده شدند.
  - **داده‌های تست (`test`):** برای ارزیابی نهایی مدل استفاده شدند.

##### **مرحله 2: آموزش مدل PyTorch**
آموزش مدل یکی از پیچیده‌ترین و مهم‌ترین مراحل این پروژه بود. در این مرحله، یک شبکه عصبی عمیق با استفاده از PyTorch طراحی و آموزش داده شد. جزئیات این مرحله عبارتند از:

- **طراحی مدل:** مدل شامل لایه‌های کاملاً متصل (`Fully Connected Layers`) و توابع فعال‌سازی (`LeakyReLU`) بود. این ساختار به منظور استخراج ویژگی‌های پیچیده از داده‌ها طراحی شد.
- **تابع هزینه:** برای آموزش مدل، از تابع هزینه `CrossEntropyLoss` استفاده شد. این تابع برای مسائل طبقه‌بندی چندکلاسه مناسب است.
- **بهینه‌ساز:** بهینه‌ساز `Adam` برای به‌روزرسانی وزن‌های مدل استفاده شد. این بهینه‌ساز به دلیل سرعت بالا و عملکرد خوب در بسیاری از مسائل یادگیری ماشین انتخاب شد.
- **جلوگیری از بیش‌برازش:** برای جلوگیری از بیش‌برازش (`Overfitting`)، از تکنیک‌های Dropout و Batch Normalization استفاده شد. این تکنیک‌ها به مدل کمک می‌کنند تا عملکرد بهتری روی داده‌های جدید داشته باشد.
- **آموزش مدل:** مدل برای 100 دوره (`Epochs`) آموزش داده شد. در هر دوره، خطای آموزش و اعتبارسنجی محاسبه و ثبت شد. این اطلاعات برای بررسی عملکرد مدل و تنظیم هایپرپارامترها استفاده شد.

##### **مرحله 3: تبدیل مدل به ONNX**
پس از آموزش مدل، آن را به فرمت ONNX تبدیل کردیم تا قابلیت انتقال به محیط‌های مختلف داشته باشد. جزئیات این مرحله عبارتند از:

- **تبدیل مدل:** برای تبدیل مدل، از تابع `torch.onnx.export` استفاده شد. این تابع یک ورودی نمونه (`dummy input`) با اندازه ورودی‌های واقعی مدل ایجاد کرده و مدل را به فرمت ONNX تبدیل می‌کند.
- **ذخیره‌سازی مدل:** مدل ONNX در فایل `compressor_status_prediction_model.onnx` ذخیره شد. این فایل قابلیت اجرا در محیط‌های مختلف، از جمله Python، C++، و سایر زبان‌ها را دارد.

##### **مرحله 4: استفاده از مدل ONNX**
در این مرحله، مدل ONNX در کلاس `CompressorStatusPredictor` بارگذاری شد و برای پیش‌بینی وضعیت کمپرسور استفاده شد. جزئیات این مرحله عبارتند از:

- **بارگذاری مدل:** مدل ONNX با استفاده از کتابخانه `onnxruntime` بارگذاری شد. این کتابخانه به منظور اجرای مدل‌های ONNX طراحی شده است.
- **دریافت داده‌ها:** داده‌های ورودی از دیتابیس خوانده شدند و به فرمت مناسب تبدیل شدند. این شامل تبدیل داده‌ها به آرایه‌های NumPy و تنظیم ابعاد آن‌ها برای ورود به مدل است.
- **پیش‌بینی:** مدل ONNX بر روی داده‌های پیش‌پردازش‌شده اجرا شده و وضعیت کمپرسور پیش‌بینی شد. خروجی مدل به صورت یک عدد صحیح (وضعیت پیش‌بینی‌شده) بازگردانده شد.

---

#### **4. نتایج**
در این پروژه، یک سیستم پیش‌بینی وضعیت کمپرسور با استفاده از دیتابیس SQL و مدل ONNX پیاده‌سازی شد. این سیستم به درستی کار کرد و وضعیت کمپرسور را بر اساس داده‌های ورودی پیش‌بینی کرد. عملکرد مدل در مراحل مختلف (آموزش، اعتبارسنجی و تست) بررسی شد و نتایج نشان داد که مدل دقت بالایی دارد.

---

#### **5. پیشنهادات برای بهبود**
برای بهبود عملکرد و دقت سیستم، پیشنهادات زیر ارائه می‌شوند:

1. **افزودن اعتبارسنجی داده‌ها:**
   - قبل از ارسال داده‌ها به مدل، اعتبارسنجی دقیق‌تری انجام شود تا از صحت داده‌ها اطمینان حاصل شود.

2. **بهینه‌سازی عملکرد:**
   - از تکنیک‌های موازی‌سازی یا کش‌سازی برای بهبود سرعت خواندن داده‌ها از دیتابیس استفاده شود.

3. **گزارش‌گیری دقیق‌تر:**
   - خروجی‌های پیش‌بینی به صورت گزارش‌های گرافیکی یا جداول نمایش داده شوند.

4. **بهبود مدل:**
   - از معماری‌های پیشرفته‌تر مانند شبکه‌های عصبی کانولوشنال (CNN) یا شبکه‌های بازگشتی (RNN) برای بهبود دقت مدل استفاده شود.

5. **افزایش داده‌ها:**
   - حجم داده‌های آموزشی افزایش یابد تا مدل بتواند الگوهای پیچیده‌تری را یاد بگیرد.

6. **استفاده از تکنیک‌های تفسیرپذیری:**
   - از تکنیک‌های تفسیرپذیری مانند SHAP یا LIME برای درک بهتر نحوه تصمیم‌گیری مدل استفاده شود.

---

#### **6. نتیجه‌گیری**
در این پروژه، یک سیستم پیش‌بینی وضعیت کمپرسور با استفاده از دیتابیس SQL و مدل ONNX پیاده‌سازی شد. این سیستم به درستی کار کرد و وضعیت کمپرسور را بر اساس داده‌های و