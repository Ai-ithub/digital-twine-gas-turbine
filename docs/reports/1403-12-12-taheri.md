
گزارش روزانه - 1403/12/12
نام: مهدی طاهری


 در این راهنما، یک مدل darts در PyTorch برای پیش‌بینی وضعیت کمپرسور بر اساس داده‌های عملیاتی طراحی می‌کنیم. همچنین از فیلتر کالمن برای کاهش نویز داده‌ها استفاده خواهیم کرد و مدل را در فرمت ONNX ذخیره می‌کنیم.

تست مدل‌های مختلف شامل:
LSTM (Long Short-Term Memory) برای یادگیری وابستگی‌های زمانی


آموزش و بهینه‌سازی مدل

تنظیم هایپرپارامترهای مدل مثل تعداد لایه‌ها، طول دنباله ورودی و نرخ یادگیری
ارزیابی دقت مدل با استفاده از RMSE و MAPE


✅ کارهای انجام‌شده:
### گزارش کار: پیش‌بینی سری زمانی با استفاده از مدل NBEATS

#### **هدف پروژه**
هدف از این پروژه، پیش‌بینی سری زمانی با استفاده از مدل **NBEATS** (Neural Basis Expansion Analysis for Time Series) است. این مدل یک شبکه عصبی عمیق برای پیش‌بینی سری‌های زمانی است که توانایی مدل‌سازی الگوهای پیچیده را دارد. در این پروژه، داده‌ها به دو بخش آموزش و اعتبارسنجی تقسیم شده‌اند و از GPU برای تسریع فرآیند آموزش استفاده شده است. همچنین، عملکرد مدل با معیار **MAPE** (Mean Absolute Percentage Error) ارزیابی شده و نتایج به صورت گرافیکی نمایش داده شده‌اند.

---

#### **مراحل انجام کار**

1. **تقسیم داده‌ها به مجموعه‌های آموزش و اعتبارسنجی**
   - داده‌ها با استفاده از تابع `split_before` به دو بخش تقسیم شده‌اند:
     - **مجموعه آموزش**: شامل داده‌های قبل از تاریخ `2025-01-01 19:26:40`.
     - **مجموعه اعتبارسنجی**: شامل داده‌های بعد از این تاریخ.
   - طول هر مجموعه نیز چاپ شده است:
     ```
     Training length: X, Validation length: Y
     ```

2. **مقیاس‌بندی داده‌ها**
   - برای بهبود عملکرد مدل، داده‌ها با استفاده از کلاس `Scaler` مقیاس‌بندی شده‌اند:
     - مجموعه آموزش با `fit_transform` مقیاس‌بندی شده است.
     - مجموعه اعتبارسنجی با `transform` مقیاس‌بندی شده است.

3. **تعریف و آموزش مدل NBEATS**
   - مدل NBEATS با پارامترهای زیر تعریف شده است:
     - **طول ورودی (`input_chunk_length`)**: 48 (به معنای استفاده از 48 نقطه زمانی گذشته برای پیش‌بینی).
     - **طول خروجی (`output_chunk_length`)**: 12 (به معنای پیش‌بینی 12 نقطه زمانی آینده).
     - **تعداد دوره‌های آموزش (`n_epochs`)**: 100.
     - **اندازه دسته (`batch_size`)**: 32.
     - **نرخ یادگیری (`lr`)**: 0.0001.
     - **استفاده از GPU**: اگر GPU در دسترس باشد، از آن استفاده می‌شود؛ در غیر این صورت از CPU استفاده می‌شود.
     - **Early Stopping**: برای جلوگیری از بیش‌برازش، از Early Stopping با نظارت بر خطای آموزش (`train_loss`) استفاده شده است. این مکانیزم پس از 10 دوره بدون بهبود متوقف می‌شود.

   - مدل با استفاده از داده‌های آموزش مقیاس‌بندی شده آموزش داده شده و عملکرد آن روی داده‌های اعتبارسنجی نیز نظارت شده است.

4. **پیش‌بینی و بازگردانی مقیاس داده‌ها**
   - پس از آموزش مدل، پیش‌بینی برای طول مجموعه اعتبارسنجی انجام شده است.
   - نتایج پیش‌بینی با استفاده از `inverse_transform` به مقیاس اصلی بازگردانده شده‌اند.

5. **ارزیابی مدل**
   - عملکرد مدل با استفاده از معیار **MAPE** ارزیابی شده است. این معیار درصد خطای مطلق میانگین را اندازه‌گیری می‌کند.
   - نتیجه MAPE چاپ شده است:
     ```
     NBEATS Model obtains MAPE: Z.ZZ%
     ```

6. **نمایش نتایج**
   - نتایج به صورت گرافیکی نمایش داده شده‌اند:
     - **نمودار اصلی**: شامل داده‌های واقعی، داده‌های آموزش، داده‌های اعتبارسنجی و پیش‌بینی‌های مدل.
     - **تحلیل باقیمانده‌ها**: نمودار باقیمانده‌ها (تفاضل بین مقادیر واقعی و پیش‌بینی‌شده) نمایش داده شده است.

---

#### **نتایج**

1. **معیار ارزیابی (MAPE)**
   - مقدار MAPE محاسبه شده است. این مقدار نشان‌دهنده دقت پیش‌بینی مدل است. هرچه این مقدار کمتر باشد، عملکرد مدل بهتر است.

2. **نمودارها**
   - **نمودار اصلی**: این نمودار نشان می‌دهد که مدل تا چه حد موفق به پیش‌بینی داده‌های آینده شده است. اگر منحنی پیش‌بینی به خوبی منحنی واقعی را دنبال کند، نشان‌دهنده عملکرد خوب مدل است.
   - **تحلیل باقیمانده‌ها**: این نمودار نشان می‌دهد که خطاها (تفاوت بین مقادیر واقعی و پیش‌بینی‌شده) چگونه توزیع شده‌اند. اگر خطاها به صورت تصادفی و بدون الگوی مشخصی توزیع شده باشند، نشان‌دهنده این است که مدل به خوبی داده‌ها را یادگیری کرده است.

---

#### **نتیجه‌گیری**
- مدل NBEATS با موفقیت آموزش داده شده و قادر به پیش‌بینی سری زمانی است.
- استفاده از GPU باعث تسریع فرآیند آموزش شده است.
- معیار MAPE نشان‌دهنده دقت پیش‌بینی مدل است. اگر این مقدار بالا باشد، ممکن است نیاز به تنظیم پارامترها یا افزایش داده‌های آموزش وجود داشته باشد.
- نمودارها و تحلیل باقیمانده‌ها نشان می‌دهند که مدل تا چه حد موفق به مدل‌سازی داده‌ها شده است.

---

#### **پیشنهادات**
1. **تنظیم پارامترها**: اگر دقت مدل کافی نباشد، می‌توان پارامترهای مدل (مانند `input_chunk_length`، `output_chunk_length`، `n_epochs` و `batch_size`) را تنظیم کرد.
2. **افزایش داده‌ها**: اگر داده‌های آموزش کافی نباشند، می‌توان با جمع‌آوری داده‌های بیشتر یا استفاده از روش‌های افزایش داده (Data Augmentation)، عملکرد مدل را بهبود بخشید.
3. **استفاده از مدل‌های دیگر**: در صورتی که مدل NBEATS نتواند به دقت مطلوب دست یابد، می‌توان از مدل‌های دیگر مانند LSTM یا Transformer استفاده کرد.

---

