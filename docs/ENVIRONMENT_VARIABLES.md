# Environment Variables Documentation

This document provides comprehensive documentation for all environment variables used in the Gas Turbine Monitoring System.

## Table of Contents
- [Database Configuration](#database-configuration)
- [InfluxDB Configuration](#influxdb-configuration)
- [Kafka Configuration](#kafka-configuration)
- [JWT Authentication](#jwt-authentication)
- [OPC-UA Configuration](#opc-ua-configuration)
- [Grafana Configuration](#grafana-configuration)
- [MLflow Configuration](#mlflow-configuration)
- [Application Configuration](#application-configuration)
- [Frontend Configuration](#frontend-configuration)

---

## Database Configuration

### `MYSQL_ROOT_PASSWORD`
- **Type:** String
- **Required:** Yes
- **Default:** None
- **Description:** Root password for MySQL database
- **Security:** Use strong password (min 16 characters)
- **Example:** `MySecureRootPassword123!@#`

### `DB_HOST`
- **Type:** String
- **Required:** Yes
- **Default:** `mysql`
- **Description:** MySQL database hostname
- **Example:** `mysql` (for Docker), `localhost` (for local)

### `DB_PORT`
- **Type:** Integer
- **Required:** Yes
- **Default:** `3306`
- **Description:** MySQL database port
- **Example:** `3306`

### `DB_USER`
- **Type:** String
- **Required:** Yes
- **Default:** `app_user`
- **Description:** MySQL database username for application
- **Example:** `app_user`

### `DB_PASSWORD`
- **Type:** String
- **Required:** Yes
- **Default:** None
- **Description:** MySQL database password for application user
- **Security:** Use strong password (min 16 characters)
- **Example:** `AppUserSecurePass456!`

### `DB_DATABASE`
- **Type:** String
- **Required:** Yes
- **Default:** `compressor_db`
- **Description:** MySQL database name
- **Example:** `compressor_db`

### `MYSQL_DATABASE`
- **Type:** String
- **Required:** Yes (for Docker initialization)
- **Default:** `compressor_db`
- **Description:** Database name for Docker MySQL initialization
- **Example:** `compressor_db`

---

## InfluxDB Configuration

### `INFLUXDB_URL`
- **Type:** String (URL)
- **Required:** Yes
- **Default:** `http://influxdb:8086`
- **Description:** InfluxDB server URL
- **Example:** `http://influxdb:8086`

### `INFLUXDB_TOKEN`
- **Type:** String
- **Required:** Yes
- **Default:** None
- **Description:** InfluxDB authentication token
- **Security:** Generated by InfluxDB on first setup
- **Example:** `your_influxdb_token_here`

### `INFLUXDB_ORG`
- **Type:** String
- **Required:** Yes
- **Default:** `your_organization`
- **Description:** InfluxDB organization name
- **Example:** `petropal`

### `INFLUXDB_BUCKET`
- **Type:** String
- **Required:** Yes
- **Default:** `compressor_metrics`
- **Description:** InfluxDB bucket name for time-series data
- **Example:** `compressor_metrics`

### `DOCKER_INFLUXDB_INIT_MODE`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** `setup`
- **Description:** InfluxDB initialization mode
- **Values:** `setup`

### `DOCKER_INFLUXDB_INIT_USERNAME`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** `admin`
- **Description:** Initial admin username for InfluxDB
- **Example:** `admin`

### `DOCKER_INFLUXDB_INIT_PASSWORD`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** None
- **Description:** Initial admin password for InfluxDB
- **Security:** Use strong password
- **Example:** `InfluxAdminPass789!`

### `DOCKER_INFLUXDB_INIT_ORG`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** `your_organization`
- **Description:** Initial organization name
- **Example:** `petropala`

### `DOCKER_INFLUXDB_INIT_BUCKET`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** `compressor_metrics`
- **Description:** Initial bucket name
- **Example:** `compressor_metrics`

### `DOCKER_INFLUXDB_INIT_ADMIN_TOKEN`
- **Type:** String
- **Required:** Yes (for Docker)
- **Default:** None
- **Description:** Initial admin token
- **Security:** Use long random string
- **Example:** `your_influxdb_token_here`

---

## Kafka Configuration

### `KAFKA_BROKER_URL`
- **Type:** String
- **Required:** Yes
- **Default:** `kafka:9092`
- **Description:** Kafka broker URL for connections
- **Example:** `kafka:9092`

### `KAFKA_BOOTSTRAP_SERVERS`
- **Type:** String
- **Required:** Yes
- **Default:** `kafka:9092`
- **Description:** Kafka bootstrap servers (comma-separated for multiple)
- **Example:** `kafka:9092`

### `KAFKA_CLUSTER_ID`
- **Type:** String (UUID)
- **Required:** Yes
- **Default:** None
- **Description:** Unique identifier for Kafka cluster
- **Security:** Generate with: `python -c "import uuid; print(str(uuid.uuid4()))"`
- **Example:** `abc123de-f456-7890-ghij-klmn12345678`

### `KAFKA_INTER_BROKER_LISTENER`
- **Type:** String
- **Required:** No
- **Default:** `PLAINTEXT`
- **Description:** Inter-broker communication protocol
- **Values:** `PLAINTEXT`, `SSL`
- **Example:** `PLAINTEXT` (development), `SSL` (production)

### SSL Configuration (Optional)
- `KAFKA_SSL_KEYSTORE_LOCATION`
- `KAFKA_SSL_KEYSTORE_PASSWORD`
- `KAFKA_SSL_KEY_PASSWORD`
- `KAFKA_SSL_TRUSTSTORE_LOCATION`
- `KAFKA_SSL_TRUSTSTORE_PASSWORD`

---

## JWT Authentication

### `JWT_SECRET_KEY`
- **Type:** String
- **Required:** **YES (CRITICAL)**
- **Default:** **NONE** (will fail if not set)
- **Description:** Secret key for JWT token signing
- **Security:** 
  - **MUST** be at least 32 characters
  - Use cryptographically secure random string
  - **NEVER** commit to version control
  - Generate with: `python -c "import secrets; print(secrets.token_urlsafe(64))"`
- **Example:** `your_very_long_random_secret_key_here_min_32_chars`

### `JWT_EXPIRATION_HOURS`
- **Type:** Integer
- **Required:** No
- **Default:** `24`
- **Description:** JWT token expiration time in hours
- **Example:** `24`

---

## OPC-UA Configuration

### `OPCUA_ENDPOINT_URL`
- **Type:** String (URL)
- **Required:** No (if OPC-UA not used)
- **Default:** `opc.tcp://localhost:4840`
- **Description:** OPC-UA server endpoint URL
- **Example:** `opc.tcp://192.168.1.100:4840`

### `OPCUA_USERNAME`
- **Type:** String
- **Required:** No
- **Default:** `opcua_user`
- **Description:** OPC-UA authentication username
- **Example:** `opcua_user`

### `OPCUA_PASSWORD`
- **Type:** String
- **Required:** No
- **Default:** None
- **Description:** OPC-UA authentication password
- **Security:** Use strong password
- **Example:** `OpcUaSecurePass123!`

---

## Grafana Configuration

### `GRAFANA_ADMIN_USER`
- **Type:** String
- **Required:** No
- **Default:** `admin`
- **Description:** Grafana admin username
- **Example:** `admin`

### `GRAFANA_ADMIN_PASSWORD`
- **Type:** String
- **Required:** No
- **Default:** `admin`
- **Description:** Grafana admin password
- **Security:** **MUST** be changed for production
- **Example:** `GrafanaAdminPass456!`

---

## MLflow Configuration

### `MLFLOW_TRACKING_URI`
- **Type:** String (URL)
- **Required:** Yes
- **Default:** `http://mlflow:5000`
- **Description:** MLflow tracking server URL
- **Example:** `http://mlflow:5000`

### `MLFLOW_BACKEND_STORE_URI`
- **Type:** String (Connection String)
- **Required:** Yes
- **Default:** `mysql+pymysql://app_user:password@mysql:3306/compressor_db`
- **Description:** MLflow backend store (database) URI
- **Example:** `mysql+pymysql://app_user:your_password@mysql:3306/compressor_db`

### `MLFLOW_DEFAULT_ARTIFACT_ROOT`
- **Type:** String (Path/URL)
- **Required:** Yes
- **Default:** `s3://mlflow-artifacts/`
- **Description:** MLflow artifacts storage location
- **Example:** `s3://mlflow-artifacts/` or `/mlflow/artifacts`

---

## Application Configuration

### `PORT`
- **Type:** Integer
- **Required:** No
- **Default:** `5000`
- **Description:** Flask application port
- **Example:** `5000`

### `FLASK_ENV`
- **Type:** String
- **Required:** No
- **Default:** `production`
- **Description:** Flask environment mode
- **Values:** `development`, `production`
- **Example:** `production`

### `FLASK_DEBUG`
- **Type:** Boolean (0/1)
- **Required:** No
- **Default:** `0`
- **Description:** Flask debug mode
- **Values:** `0` (off), `1` (on)
- **Security:** **MUST** be `0` in production
- **Example:** `0`

### `CORS_ALLOWED_ORIGINS`
- **Type:** String (comma-separated)
- **Required:** No
- **Default:** `http://localhost:5173,http://localhost:3000`
- **Description:** Allowed CORS origins for API
- **Security:** Specify exact origins in production
- **Example:** `http://localhost:5173,https://yourdomain.com`

---

## Frontend Configuration

### `VITE_API_BASE_URL`
- **Type:** String (URL)
- **Required:** No
- **Default:** `http://localhost:5000/api`
- **Description:** Backend API base URL
- **Example:** `http://localhost:5000/api` (dev), `https://api.yourdomain.com/api` (prod)

### `VITE_SOCKET_URL`
- **Type:** String (URL)
- **Required:** No
- **Default:** `http://localhost:5000`
- **Description:** WebSocket server URL
- **Example:** `http://localhost:5000` (dev), `https://api.yourdomain.com` (prod)

---

## Security Best Practices

1. **Never commit `.env` files to version control**
   - Use `.env.example` as a template
   - Add `.env` to `.gitignore`

2. **Use strong passwords**
   - Minimum 16 characters
   - Mix of uppercase, lowercase, numbers, symbols
   - Different password for each service

3. **Generate secure random keys**
   ```bash
   # JWT Secret
   python -c "import secrets; print(secrets.token_urlsafe(64))"
   
   # Kafka Cluster ID
   python -c "import uuid; print(str(uuid.uuid4()))"
   ```

4. **Rotate secrets regularly**
   - Passwords: every 90 days
   - JWT keys: every 180 days
   - API tokens: every 90 days

5. **Use environment-specific values**
   - Different credentials for dev/staging/production
   - Use secret management tools (Vault, AWS Secrets Manager)

---

## Quick Setup Guide

1. Copy `.env.example` to `.env`:
   ```bash
   cp .env.example .env
   ```

2. Generate secure keys:
   ```bash
   # Generate JWT Secret
   python -c "import secrets; print('JWT_SECRET_KEY=' + secrets.token_urlsafe(64))"
   
   # Generate Kafka Cluster ID
   python -c "import uuid; print('KAFKA_CLUSTER_ID=' + str(uuid.uuid4()))"
   ```

3. Update passwords in `.env`

4. For frontend:
   ```bash
   cd frontend
   cp .env.example .env
   ```

5. **Never commit `.env` files!**

---

## Troubleshooting

### JWT_SECRET_KEY Error
**Error:** `ValueError: JWT_SECRET_KEY environment variable is not set!`

**Solution:** Set `JWT_SECRET_KEY` in `.env` file with a secure random string (min 32 chars)

### Database Connection Error
**Error:** `Access denied for user`

**Solution:** Check `DB_USER`, `DB_PASSWORD`, and `DB_HOST` in `.env`

### Kafka Connection Failed
**Error:** `NoBrokersAvailable`

**Solution:** Ensure Kafka is running and `KAFKA_BROKER_URL` is correct

---

For more information, see:
- [Quick Start Guide](../QUICK_START.md)
- [Complete Setup Guide](./COMPLETE_SETUP_GUIDE.md)
- [Security Implementation](../SECURITY_IMPLEMENTATION_SUMMARY.md)

