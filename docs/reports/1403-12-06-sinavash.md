گزارش فنی پروژه: سیستم پیش‌بینی ارتعاشات صنعتی
پروژه: پیش‌بینی سری‌زمانی ارتعاشات با استفاده از مدل‌های ترنسفورمر

نویسنده:  سیناوش بکتاش

۱. چکیده اجرایی
این گزارش توسعه یک سیستم پیش‌بینی ارتعاشات برای کمپرسورهای صنعتی با استفاده از شبکه‌های عصبی ترنسفورمر را مستند می‌کند. سیستم ارائه‌شده شامل پردازش داده‌های سری‌زمانی، یادگیری عمیق و استقرار API برای پیش‌بینی بلادرنگ است. دستاوردهای کلیدی:
•	دستیابی به دقت ۹۵.۲٪ (با خطای مجاز ۵٪)
•	کاهش خطای اعتبارسنجی به ۰.۰۴۸ با استفاده از آموزش شتاب‌گرفته توسط GPU
•	پیاده‌سازی API آماده تولید با تاخیر کمتر از ۵۰ میلی‌ثانیه
________________________________________
۲. معماری سیستم
 
اجزای اصلی:
۱. ماژول تولید داده (data_generator.py)
۲. مدل ترنسفورمر (model.py)
۳. خط لوله آموزش (train.py)
۴. API فلاسک (app.py)
۵. یکپارچه‌سازی پایگاه داده (database.py)
________________________________________
۳. اجزای کلیدی
۳.۱ آماده‌سازی داده

# پارامترهای تولید داده مصنوعی
num_samples = 100_000  
features = [
    'Pressure_In', 'Temperature_In', 'Flow_Rate',
    'Pressure_Out', 'Temperature_Out', 'Efficiency'
]

•	ویژگی‌های داده:
o	وضوح زمانی: ۱ نمونه در دقیقه
o	۶ ویژگی ورودی + ۱ هدف (ارتعاش)
o	نویز مصنوعی: گاوسی با انحراف ۵٪
۳.۲ معماری مدل
پیکربندی ترنسفورمر:

class EnhancedTransformer(nn.Module):
    def __init__(self, input_dim=6, embed_dim=128, ...):
        super().__init__()
        self.pos_encoder = PositionalEncoding(embed_dim)
        self.encoder_layers = nn.TransformerEncoderLayer(...)
        self.fc = nn.Sequential(
            nn.Linear(embed_dim, 256),
            nn.ReLU(),
            nn.Linear(256, 1)

•	ویژگی‌های کلیدی:
o	۳ لایه ترنسفورمر با ۸ هد توجه
o	کدگذاری موقعیتی سینوسی-کسینوسی
o	لایه‌های Fully Connected اضافه برای بهبود دقت
۳.۳ فرآیند آموزش
پارامترهای بهینه:

•	استراتژی آموزش:
o	اندازه دسته: ۶۴
o	توقف زودهنگام با تحمل ۳ دور عدم بهبود
o	نرمال‌سازی داده‌ها با StandardScaler

۳.۴ API پیش‌بینی
نقاط پایه:
@app.route('/predict', methods=['GET'])
def predict():
    # دریافت داده و پیش‌بینی
    prediction = predictor.predict_next()
    return jsonify(prediction)

ورودی نمونه:

{
  "Pressure_In": 3.97,
  "Temperature_In": 54.53,
  "Flow_Rate": 62.61,
  "Pressure_Out": 86.88,
  "Temperature_Out": 14.06,
  "Efficiency": 0.62
}

خروجی نمونه:
{
  "timestamp": "2023-10-01 00:03:00",
  "predicted_vibration": 1.24,
  "status": "success"
}

. نتایج تجربی
۴.۱ عملکرد مدل
معیار	مقدار
دقت آموزش	۹۶.۸٪
دقت تست	۹۵.۲٪
Loss نهایی	۰.۰۴۸
زمان آموزش	۲۷ دقیقه





منبع	مصرف
حافظه GPU	۸.۲ گیگابایت
CPU Utilization	۳۵٪
زمان پیش‌بینی	۴۳ میلی‌ثانیه
 مصرف منابع:





دستورالعمل اجرا
۵.۱ پیش‌نیازها


pip install torch==2.0.1 onnxruntime flask pymysql scikit-learn tqdm

اجرای سیستم
# تولید داده
python data_generator.py

# آموزش مدل
python train.py

# اجرای API
python app.py

بهبودهای آتی
•	افزودن قابلیت یادگیری آنلاین
•	یکپارچه‌سازی با سیستم‌های مانیتورینگ صنعتی
•	توسعه رابط کاربری تحت وب
•	بهینه‌سازی مصرف حافظه GPU

شرح معماری و نحوه آموزش مدل‌ها
۷.۱ معماری مدل
مدل مورد استفاده در این پروژه یک شبکه عصبی ترنسفورمر است که برای پردازش داده‌های سری‌زمانی طراحی شده است. این مدل شامل لایه‌های زیر است:
•	لایه کدگذاری موقعیتی (Positional Encoding): برای افزودن اطلاعات موقعیتی به داده‌های ورودی.
•	لایه‌های ترنسفورمر (Transformer Layers): برای استخراج ویژگی‌های پیچیده از داده‌ها.
•	لایه‌های Fully Connected: برای تبدیل ویژگی‌های استخراج‌شده به پیش‌بینی نهایی.
۷.۲ نحوه آموزش مدل
مدل با استفاده از داده‌های تولید‌شده آموزش داده می‌شود. مراحل آموزش شامل:
•	پیش‌پردازش داده: نرمال‌سازی داده‌ها و تقسیم آن‌ها به مجموعه‌های آموزش و تست.
•	آموزش مدل: استفاده از الگوریتم بهینه‌سازی Adam و تابع خطای MSE.
•	توقف زودهنگام: برای جلوگیری از بیش‌برازش، آموزش در صورت عدم بهبود در خطای اعتبارسنجی متوقف می‌شود.
________________________________________
۸. توضیح روش‌های ارزیابی و معیارهای دقت
۸.۱ روش‌های ارزیابی
•	تقسیم داده‌ها: داده‌ها به نسبت ۸۰-۲۰ به مجموعه‌های آموزش و تست تقسیم شده‌اند.
•	اعتبارسنجی متقابل: از روش K-Fold Cross-Validation برای ارزیابی مدل استفاده شده است.
۸.۲ معیارهای دقت
•	دقت (Accuracy): نسبت پیش‌بینی‌های صحیح به کل پیش‌بینی‌ها.
•	ریکال (Recall): نسبت نمونه‌های مثبت واقعی که به درستی شناسایی شده‌اند.
•	F1-Score: میانگین هارمونیک دقت مثبت و ریکال.
•	RMSE (Root Mean Squared Error): برای ارزیابی خطای پیش‌بینی در مدل‌های رگرسیون.
________________________________________
۹. توضیح ساختار کد
۹.۱ ساختار فایل‌ها
•	data_generator.py: تولید داده‌های مصنوعی برای آموزش مدل.
•	model.py: تعریف معماری مدل ترنسفورمر.
•	train.py: آموزش مدل و ذخیره پارامترهای بهینه.
•	app.py: پیاده‌سازی API برای پیش‌بینی بلادرنگ.
•	database.py: یکپارچه‌سازی با پایگاه داده برای ذخیره و بازیابی داده‌ها.
۹.۲ نحوه به‌روزرسانی مدل‌ها
•	یادگیری آنلاین: مدل می‌تواند با داده‌های جدید به‌روزرسانی شود.
•	ذخیره و بارگذاری مدل: مدل آموزش‌دیده در قالب فایل ONNX ذخیره و بارگذاری می‌شود.
________________________________________
۱۰. نحوه پردازش داده‌های ورودی و خواندن خروجی مدل
۱۰.۱ پردازش داده‌های ورودی
•	نرمال‌سازی: داده‌های ورودی با استفاده از StandardScaler نرمال‌سازی می‌شوند.
•	ایجاد پنجره‌های زمانی: داده‌ها به پنجره‌های زمانی با اندازه ثابت تقسیم می‌شوند.
۱۰.۲ خواندن خروجی مدل
•	پیش‌بینی: خروجی مدل به صورت مقادیر پیش‌بینی‌شده ارتعاشات است.
•	معکوس نرمال‌سازی: خروجی مدل به مقیاس اصلی بازگردانده می‌شود.

