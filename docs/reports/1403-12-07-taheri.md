
گزارش روزانه - ۱1403/12/07
نام: مهدی طاهری 
وظیفه:
در این وظیفه، هدف ما توسعه‌ی یک مدل شبکه عصبی بازگشتی (LSTM) برای پیش‌بینی باقی‌مانده عمر مفید (RUL - Remaining Useful Life) یک تجهیز صنعتی، بر اساس داده‌های سنسوری آن است. مدل از داده‌های سری زمانی استفاده کرده و مقدار RUL را برای هر نمونه تخمین می‌زند.


✅ کارهای انجام‌شده:
بارگذاری داده‌ها
•	فایل داده‌ها با استفاده از کتابخانه pandas بارگذاری شد. فرض بر این است که فایل CSV شامل داده‌های مربوط به حسگرها و وضعیت سیستم (مانند عمر مفید باقی‌مانده - RUL) است.
•	ستون‌های مرتبط با ویژگی‌ها (features) و هدف (target) جدا شدند. در اینجا، ستون Status به عنوان هدف در نظر گرفته شده است.
________________________________________
2. پیش‌پردازش داده‌ها
•	نرمال‌سازی ویژگی‌ها : برای کاهش تأثیر مقیاس داده‌ها، تمام ویژگی‌ها با استفاده از MinMaxScaler نرمال‌سازی شدند. این کار باعث می‌شود که مقادیر ویژگی‌ها در بازه [0, 1] قرار گیرند.
•	ایجاد دنباله‌ها (Sequences) : برای آموزش مدل LSTM، داده‌ها به دنباله‌هایی با طول مشخص (seq_length=10) تقسیم شدند. هر دنباله شامل 10 نمونه متوالی از داده‌ها است و خروجی متناظر با آخرین نمونه در دنباله به عنوان هدف در نظر گرفته شد.
•	تقسیم داده‌ها : داده‌ها به دو مجموعه آموزش و آزمون تقسیم شدند (80% برای آموزش و 20% برای آزمون).
•	تبدیل به تنسور : داده‌ها به تنسورهای PyTorch تبدیل شدند تا بتوان از آن‌ها در مدل‌های عصبی استفاده کرد.
________________________________________
3. تعریف مدل LSTM
•	یک مدل شبکه عصبی با استفاده از لایه‌های LSTM تعریف شد:
•	LSTM Layer : این لایه برای پردازش دنباله‌های زمانی استفاده می‌شود و قادر است وابستگی‌های بلندمدت را در داده‌ها تشخیص دهد.
•	Fully Connected Layer : خروجی لایه LSTM به یک لایه کاملاً متصل منتقل می‌شود تا نتیجه نهایی (RUL) تولید شود.
•	پارامترهای مدل شامل اندازه ورودی (input_size), اندازه مخفی (hidden_size), تعداد لایه‌های LSTM (num_layers) و اندازه خروجی (output_size) تنظیم شدند.
________________________________________
4. آموزش مدل
•	تابع هزینه : از معیار میانگین مربعات خطای (MSE) برای محاسبه خطای بین مقادیر پیش‌بینی‌شده و واقعی استفاده شد.
•	بهینه‌ساز : از الگوریتم Adam برای بهینه‌سازی وزن‌های مدل استفاده شد.
•	آموزش : مدل به مدت 100 دوره (epoch) آموزش داده شد. در هر دوره، داده‌های آموزشی به صورت دسته‌ای (batch size=64) به مدل داده شدند و خطای مدل محاسبه و به‌روزرسانی وزن‌ها انجام شد.
•	چاپ خطای آموزش : خطای میانگین در هر دوره چاپ شد تا پیشرفت آموزش قابل مشاهده باشد.
________________________________________
5. ارزیابی مدل
•	مدل روی داده‌های آزمون ارزیابی شد. برای این منظور، مدل در حالت ارزیابی (model.eval()) قرار گرفت و پیش‌بینی‌ها برای داده‌های آزمون محاسبه شدند.
•	مقادیر پیش‌بینی‌شده و واقعی ذخیره شدند تا بتوان نتایج را تجسم کرد.
________________________________________
6. ذخیره مدل در فرمت ONNX
•	مدل آموزش‌دیده به فرمت ONNX تبدیل و ذخیره شد. این کار برای استقرار مدل در محیط‌های مختلف (مانند سرورها یا دستگاه‌های موبایل) انجام شد.
•	یک ورودی نمونه (dummy_input) برای تعریف ساختار مدل در فرمت ONNX استفاده شد.
________________________________________
7. تجسم نتایج
•	نتایج پیش‌بینی‌شده و مقادیر واقعی با استفاده از کتابخانه matplotlib تجسم شدند.
•	نمودار شامل دو خط است:
•	خط آبی: مقادیر واقعی RUL
•	خط قرمز: مقادیر پیش‌بینی‌شده RUL
•	این نمودار به بررسی عملکرد مدل کمک می‌کند و نشان می‌دهد که آیا مدل موفق به یادگیری الگوهای داده‌ها شده است یا خیر.
________________________________________
نتیجه‌گیری
این کد یک فرآیند کامل برای پیش‌بینی عمر مفید باقی‌مانده (RUL) با استفاده از مدل LSTM ارائه می‌دهد. مراحل شامل بارگذاری داده‌ها، پیش‌پردازش، آموزش مدل، ارزیابی و تجسم نتایج است. مدل آموزش‌داده‌شده می‌تواند برای پیش‌بینی وضعیت سیستم در آینده استفاده شود و به بهبود عملکرد و کاهش هزینه‌های نگهداری کمک کند.
پیشنهادات برای بهبود:
1.	افزایش تعداد دوره‌های آموزش یا تنظیم دقیق‌تر پارامترها (مانند اندازه دسته، نرخ یادگیری) می‌تواند دقت مدل را بهبود بخشد.
2.	استفاده از روش‌های اعتبارسنجی متقابل (Cross-Validation) برای ارزیابی دقیق‌تر مدل.
3.	بررسی تأثیر ویژگی‌های مختلف بر عملکرد مدل و حذف ویژگی‌های غیرضروری.
