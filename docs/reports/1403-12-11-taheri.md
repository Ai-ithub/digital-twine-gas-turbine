
گزارش روزانه - 1403/12/11
نام: مهدی طاهری


 در این راهنما، یک مدل darts در PyTorch برای پیش‌بینی وضعیت کمپرسور بر اساس داده‌های عملیاتی طراحی می‌کنیم. همچنین از فیلتر کالمن برای کاهش نویز داده‌ها استفاده خواهیم کرد و مدل را در فرمت ONNX ذخیره می‌کنیم.

تست مدل‌های مختلف شامل:
LSTM (Long Short-Term Memory) برای یادگیری وابستگی‌های زمانی


آموزش و بهینه‌سازی مدل

تنظیم هایپرپارامترهای مدل مثل تعداد لایه‌ها، طول دنباله ورودی و نرخ یادگیری
ارزیابی دقت مدل با استفاده از RMSE و MAPE


✅ کارهای انجام‌شده:
### **گزارش کار: پیاده‌سازی مدل پیش‌بینی سری زمانی با استفاده از Darts و NBEATS**

---

#### **1. مقدمه**
در این پروژه، یک مدل پیش‌بینی سری زمانی با استفاده از کتابخانه **Darts** و مدل **NBEATS** پیاده‌سازی شده است. هدف اصلی پروژه، پیش‌بینی داده‌های فیلتر شده ارتعاش (`Vibration_filtered`) بر اساس داده‌های زمانی (`Timestamp`) است. این مدل می‌تواند در حوزه‌های مختلفی مانند نظارت بر تجهیزات صنعتی، تشخیص خطا و پیش‌بینی رفتار سیستم‌ها مورد استفاده قرار گیرد.

---

#### **2. بخش‌های اصلی پروژه**

##### **2.1. بررسی دسترسی به GPU**
- در ابتدا، دسترسی به GPU بررسی شد. اگر GPU موجود باشد، آموزش مدل روی GPU انجام می‌شود؛ در غیر این صورت، آموزش روی CPU انجام می‌شود.
- این بخش بهینه‌سازی عملکرد آموزش مدل را تسهیل می‌کند.

##### **2.2. بارگذاری و بررسی داده‌ها**
- داده‌ها از فایل `final_data.csv` خوانده شدند.
- ستون‌های `Timestamp` (زمان) و `Vibration_filtered` (داده‌های فیلتر شده ارتعاش) به عنوان ستون‌های اصلی بررسی شدند.
- در صورت وجود مقادیر اشتباه یا گم‌شده در ستون `Timestamp`، خطایی ایجاد می‌شود.
- مقادیر گم‌شده در ستون `Vibration_filtered` با استفاده از درون‌یابی خطی پر شدند.

##### **2.3. ایجاد شیء TimeSeries**
- داده‌ها به شیء `TimeSeries` تبدیل شدند. این شیء برای کار با مدل‌های سری زمانی در کتابخانه Darts استفاده می‌شود.
- ستون `Timestamp` به عنوان محور زمانی و ستون `Vibration_filtered` به عنوان مقادیر سری زمانی مشخص شد.

##### **2.4. تقسیم داده‌ها به مجموعه‌های آموزش و اعتبارسنجی**
- داده‌ها به دو بخش تقسیم شدند:
  - **Train**: داده‌های قبل از تاریخ `2025-01-01 08:19:59` برای آموزش مدل.
  - **Validation**: داده‌های بعد از این تاریخ برای اعتبارسنجی مدل.

##### **2.5. مقیاس‌بندی داده‌ها (غیرفعال شده)**
- این بخش (غیرفعال شده) برای مقیاس‌بندی داده‌ها استفاده می‌شود تا مقادیر به یک بازه مشخص (مثل [0, 1]) تبدیل شوند.
- مقیاس‌بندی معمولاً برای بهبود عملکرد مدل‌های یادگیری عمیق توصیه می‌شود.

##### **2.6. تعریف و آموزش مدل NBEATS (غیرفعال شده)**
- مدل **NBEATS** تعریف شد. این مدل یک شبکه عصبی عمیق برای پیش‌بینی سری زمانی است.
- پارامترهای مهم مدل شامل:
  - `input_chunk_length`: طول داده‌های ورودی.
  - `output_chunk_length`: افق پیش‌بینی.
  - `n_epochs`: تعداد دوره‌های آموزش.
  - `batch_size`: اندازه دسته.
  - `optimizer_kwargs`: تنظیمات بهینه‌ساز.
  - `pl_trainer_kwargs`: تنظیمات PyTorch Lightning (مثل استفاده از GPU و Early Stopping).

##### **2.7. ارزیابی مدل (غیرفعال شده)**
- عملکرد مدل با استفاده از معیار **MAPE** (خطای مطلق درصدی میانگین) ارزیابی شد.
- MAPE نشان می‌دهد که مدل به چه میزان خطا در پیش‌بینی دارد.

##### **2.8. رسم نتایج (غیرفعال شده)**
- نتایج پیش‌بینی شده توسط مدل و داده‌های واقعی رسم شدند.
- این بخش به تحلیل بصری عملکرد مدل کمک می‌کند.

##### **2.9. تحلیل باقی‌مانده‌ها (غیرفعال شده)**
- باقی‌مانده‌ها (تفاوت بین مقادیر واقعی و پیش‌بینی‌شده) تحلیل شدند.
- این تحلیل به شناسایی نقاط ضعف مدل کمک می‌کند.

##### **2.10. ذخیره مدل به فرمت ONNX (غیرفعال شده)**
- مدل به فرمت **ONNX** ذخیره شد تا بتواند در سایر محیط‌ها یا برنامه‌ها استفاده شود.

---

#### **3. نتایج و تحلیل**
- **پیش‌پردازش داده‌ها**: داده‌ها به درستی پیش‌پردازش شدند و مقادیر گم‌شده با استفاده از درون‌یابی خطی پر شدند.
- **تقسیم داده‌ها**: داده‌ها به دو بخش آموزش و اعتبارسنجی تقسیم شدند که این کار به ارزیابی دقیق‌تر مدل کمک می‌کند.
- **مدل NBEATS**: این مدل به دلیل قابلیت‌های بالا در پیش‌بینی سری زمانی انتخاب شد. پارامترهای آن به گونه‌ای تنظیم شدند که عملکرد بهینه داشته باشد.
- **ارزیابی مدل**: از معیار MAPE برای ارزیابی عملکرد مدل استفاده شد که نشان‌دهنده دقت پیش‌بینی مدل است.
- **تحلیل بصری**: نتایج پیش‌بینی و باقی‌مانده‌ها به صورت بصری تحلیل شدند که به درک بهتر عملکرد مدل کمک می‌کند.

---

#### **4. چالش‌ها و پیشنهادات**
- **چالش‌ها**:
  - اگر داده‌ها حجیم باشند، آموزش مدل ممکن است زمان‌بر باشد.
  - در صورت عدم دسترسی به GPU، آموزش مدل روی CPU ممکن است کند باشد.
- **پیشنهادات**:
  - استفاده از مقیاس‌بندی داده‌ها برای بهبود عملکرد مدل.
  - افزایش تعداد دوره‌های آموزش (`n_epochs`) برای بهبود دقت مدل.
  - استفاده از Early Stopping برای جلوگیری از Overfitting.

---

#### **5. نتیجه‌گیری**
این پروژه نشان داد که مدل **NBEATS** می‌تواند به خوبی برای پیش‌بینی سری زمانی استفاده شود. با انجام پیش‌پردازش مناسب داده‌ها و تنظیم پارامترهای مدل، می‌توان دقت پیش‌بینی را بهبود داد. این مدل می‌تواند در کاربردهای مختلفی مانند نظارت بر تجهیزات صنعتی و پیش‌بینی رفتار سیستم‌ها مورد استفاده قرار گیرد.

---

#### **6. ضمائم**
- **کتابخانه‌های استفاده‌شده**:
  - `darts`: برای کار با مدل‌های سری زمانی.
  - `pandas`, `numpy`: برای پیش‌پردازش داده‌ها.
  - `matplotlib`: برای رسم نتایج.
  - `torch`, `pytorch_lightning`: برای آموزش مدل.
- **فرمت داده‌ها**: فایل `final_data.csv` باید شامل ستون‌های `Timestamp` و `Vibration_filtered` باشد.

---

**پایان گزارش کار**